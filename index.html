<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>VIT√ìRIA ‚Äî Sistema de Portaria</title>
  <link rel="stylesheet" href="index.css">
</head>
<body>
    
  <header>
    <div style="display: flex; align-items: center; width: 100%;">
      <div class="brand">
        <div class="logo">V</div>
        <div>
          <div class="subtitle">Controle de portaria inteligente</div>
        </div>
      </div>
      <button id="btnLogout" class="btn btn-outline" style="margin-left: auto; margin-right: 1.25rem;">Sair</button>
    </div>

    <nav class="tabs" id="tabs">
      <button class="tab active" data-tab="registro">Registro de ve√≠culos</button>
      <button class="tab" data-tab="porteiros">Cadastro de porteiros</button>
      <button class="tab" data-tab="auditoria">Protocolos e relat√≥rios</button>
      <button class="tab" data-tab="autorizados">Ve√≠culos autorizados a entrar</button>
    </nav>
  </header>

  <main class="container">
    
    <section class="card" data-panel="registro">
      <div class="card-header">
        <div class="card-title">Registrar entrada/sa√≠da</div>
        <div class="badge" id="activeGuardBadge">Porteiros : carregando...</div>
      </div>
      <div class="card-body">
        <div class="grid">
          <div>
            <form id="formRecord">
              <div class="form-row-4">
                <div>
                  <label>Nome do visitante/fornecedor</label>
                  <input type="text" id="name" placeholder="Ex.: Jo√£o Silva" required />
                </div>
                <div>
                  <label>Placa do ve√≠culo</label>
                  <div style="display: flex; gap: 5px;">
                    <input type="text" id="plate" placeholder="Ex.: ABC1D23" required style="flex: 1;" />
                    <button type="button" class="btn" title="Consultar Modelo"
                            style="background: #f1c40f; color: #000; width: 45px; padding: 0; font-size: 1.2rem;" 
                            onclick="consultarPlaca()">
                      üîç
                    </button>
                  </div>
                </div>
                <div>
                  <label>Hora de entrada</label>
                  <input type="datetime-local" id="inTime" />
                </div>
                <div>
                  <label>Hora de sa√≠da</label>
                  <input type="datetime-local" id="outTime" />
                </div>
              </div>

              <div class="form-row" style="margin-top:.75rem">
                <div style="flex: 1;">
                  <label>Categorizar Entrada</label>
                  <select id="serviceType" required></select>
                </div>
                <div style="display:flex; align-items:flex-end; gap:.5rem">
                  <button type="button" class="btn btn-outline" onclick="document.getElementById('inTime').value = new Date().toLocaleString('sv-SE').slice(0,16).replace(' ', 'T')">Entrada agora</button>
                  <button type="button" class="btn btn-outline" onclick="document.getElementById('outTime').value = new Date().toLocaleString('sv-SE').slice(0,16).replace(' ', 'T')">Sa√≠da agora</button>
                </div>
              </div>

              <div style="margin-top:1rem; display:flex; gap:.6rem; flex-wrap:wrap">
                <button type="submit" class="btn btn-primary">Salvar registro</button>
                <button type="reset" class="btn btn-outline">Limpar campos</button>
                <button type="button" class="btn btn-outline" id="btnClearRecords" style="border-color: #e74c3c; color: #e74c3c;">Apagar Banco de Dados</button>
              </div>
            </form>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">√öltimos 10 registros</div>
              <div class="badge" id="countBadge">0 registros</div>
            </div>
            <div class="card-body" style="max-height:360px; overflow:auto">
              <table>
                <thead>
                  <tr>
                    <th>Nome</th><th>Placa</th><th>Entrada</th><th>Sa√≠da</th><th>Servi√ßo</th>
                    <th style="text-align: center;">Autorizar</th>
                  </tr>
                </thead>
                <tbody id="recentTable"></tbody>
              </table>
              <p style="font-size: 0.7rem; color: #888; text-align: center; margin-top: 10px;">Dica: Clique no nome para editar ou no bot√£o verde para autorizar fixo.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="card" data-panel="autorizados" style="display:none">
      <div class="card-header">
        <div class="card-title">Ve√≠culos Autorizados (Fixos)</div>
        <div class="badge" id="authCountBadge">0 cadastrados</div>
      </div>
      <div class="card-body">
        <div class="search-box" style="margin-bottom: 1rem;">
          <label>Buscar na lista de autorizados</label>
          <input type="text" id="authSearch" placeholder="Digite nome ou placa para buscar..." onkeyup="filterAuthorizedTable()" />
        </div>
        <div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
          <table>
            <thead>
              <tr>
                <th>Nome</th>
                <th>Placa</th>
                <th>Modelo</th> <th>V√≠nculo</th>
                <th>A√ß√£o</th>
              </tr>
            </thead>
            <tbody id="authorizedTableBody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="card" data-panel="porteiros" style="display:none">
      <div class="card-header"><div class="card-title">Gest√£o de Equipe</div></div>
      <div class="card-body">
        <div class="grid">
          <div>
            <form id="formGuard">
              <div class="form-row"><label>Nome do novo porteiro</label><input type="text" id="guardName" placeholder="Ex.: Maria Souza" required /></div>
              <div class="form-row"><label>Login de Acesso</label><input type="text" id="guardId" placeholder="Ex.: maria_souza" required /></div>
              <button type="submit" class="btn btn-primary">Cadastrar na Base</button>
            </form>
          </div>
          <div class="table-responsive">
            <table>
              <thead><tr><th>Nome</th><th>Login</th><th>Status</th><th>A√ß√£o</th></tr></thead>
              <tbody id="guardsTable"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <section class="card" data-panel="auditoria" style="display:none">
      <div class="card-header"><div class="card-title">Relat√≥rios e Filtros</div></div>
      <div class="card-body">
        <div class="form-row-3">
          <div><label>Filtrar por Servi√ßo</label><select id="auditServiceFilter"></select></div>
          <div><label>Data In√≠cio</label><input type="date" id="auditStart" /></div>
          <div><label>Data Fim</label><input type="date" id="auditEnd" /></div>
        </div>
        <div style="margin-top:1rem; display:flex; gap:.6rem">
          <button class="btn btn-primary" id="btnFilter">Aplicar Filtros</button>
          <button class="btn btn-outline" id="btnExport">Imprimir Relat√≥rio</button>
        </div>
        <div class="card" style="margin-top:1rem">
          <div class="table-responsive" style="max-height:420px;">
            <table>
              <thead><tr><th>Nome</th><th>Placa</th><th>Entrada</th><th>Sa√≠da</th><th>Servi√ßo</th><th>Porteiro</th></tr></thead>
              <tbody id="auditTableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="toast" id="toast"></div>
  <script src="script.js" defer></script>
</body>
</html>
